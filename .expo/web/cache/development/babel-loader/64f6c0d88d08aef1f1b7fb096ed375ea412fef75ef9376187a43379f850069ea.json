{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useState } from 'react';\nimport { Text, Box, VStack, Input, Icon, Center, ScrollView } from 'native-base';\nimport Search from \"../assets/Search.svg\";\nimport { useNavigation } from '@react-navigation/native';\nimport { useForegroundPermissions, watchPositionAsync, LocationAccuracy } from 'expo-location';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Loading } from \"../components/Loading\";\nimport { getAddressLocation } from \"../utils/getAddressLocation\";\nimport { ArtistsFeed } from \"../components/ArtistsFeed\";\nimport { EventsDisplay } from \"../components/EventsDisplay\";\nimport { UpcomingEvents } from \"../components/EventsDisplay\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport function EventsFeed() {\n  var _useForegroundPermiss = useForegroundPermissions(),\n    _useForegroundPermiss2 = _slicedToArray(_useForegroundPermiss, 2),\n    locationForegroundPermission = _useForegroundPermiss2[0],\n    requestLocationForegroundPermission = _useForegroundPermiss2[1];\n  var _useState = useState(true),\n    _useState2 = _slicedToArray(_useState, 2),\n    isLoadingLocation = _useState2[0],\n    setIsLoadingLocation = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    currentAddress = _useState4[0],\n    setCurrentAddress = _useState4[1];\n  var _useState5 = useState(''),\n    _useState6 = _slicedToArray(_useState5, 2),\n    inputValue = _useState6[0],\n    setInputValue = _useState6[1];\n  var _useState7 = useState(null),\n    _useState8 = _slicedToArray(_useState7, 2),\n    selectedCity = _useState8[0],\n    setSelectedCity = _useState8[1];\n  var navigation = useNavigation();\n  useEffect(function () {\n    requestLocationForegroundPermission();\n  }, []);\n  useEffect(function () {\n    if (!(locationForegroundPermission != null && locationForegroundPermission.granted)) {\n      return;\n    }\n    var subscription;\n    watchPositionAsync({\n      accuracy: LocationAccuracy.High,\n      timeInterval: 1000\n    }, function (location) {\n      getAddressLocation(location.coords).then(function (address) {\n        if (address) {\n          setCurrentAddress(address);\n        }\n      }).finally(function () {\n        return setIsLoadingLocation(false);\n      });\n    }).then(function (response) {\n      return subscription = response;\n    });\n    return function () {\n      if (subscription) {\n        subscription.remove();\n      }\n    };\n  }, [locationForegroundPermission]);\n  var handleSearch = function () {\n    var _ref = _asyncToGenerator(function* () {\n      var location = yield getAddressLocation({\n        latitude: 0,\n        longitude: 0\n      });\n      if (location) {\n        yield AsyncStorage.setItem('selectedLocation', JSON.stringify(location));\n        setSelectedCity(inputValue);\n        setInputValue('');\n      }\n      navigation.navigate('event_details');\n    });\n    return function handleSearch() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  if (!(locationForegroundPermission != null && locationForegroundPermission.granted)) {\n    return _jsx(Text, {\n      color: \"gray.100\",\n      fontSize: \"lg\",\n      textAlign: \"center\",\n      margin: 24,\n      children: \"To discover all upcoming music events, allow location access. Head to your device settings and grant Luster permission to access your location.\"\n    });\n  }\n  if (isLoadingLocation) {\n    return _jsx(Loading, {});\n  }\n  return _jsx(ScrollView, {\n    contentContainerStyle: {\n      flexGrow: 1\n    },\n    showsHorizontalScrollIndicator: false,\n    children: _jsxs(VStack, {\n      flex: 1,\n      bg: \"gray.700\",\n      px: 22,\n      children: [_jsx(Text, {\n        color: \"gray.100\",\n        fontSize: \"sm\",\n        fontWeight: 400,\n        mt: 20,\n        children: \"Your Location\"\n      }), selectedCity ? _jsx(Center, {\n        children: _jsx(Text, {\n          color: \"gray.100\",\n          fontSize: \"xl\",\n          children: selectedCity\n        })\n      }) : _jsx(Text, {\n        color: \"gray.100\",\n        fontSize: \"lg\",\n        fontWeight: 700,\n        children: currentAddress\n      }), _jsx(Input, {\n        px: 2,\n        h: 14,\n        mt: 4,\n        borderRadius: 8,\n        backgroundColor: \"transparent\",\n        borderWidth: 0.4,\n        fontSize: \"xs\",\n        fontFamily: \"body\",\n        placeholder: \"Search\",\n        color: \"gray.100\",\n        value: inputValue,\n        onChangeText: function onChangeText(text) {\n          return setInputValue(text);\n        },\n        _focus: {\n          borderWidth: 1,\n          borderColor: 'purple.900'\n        },\n        onSubmitEditing: handleSearch,\n        InputRightElement: _jsx(Box, {\n          mr: 2,\n          mt: 1.8,\n          children: _jsx(Icon, {\n            as: _jsx(Search, {}),\n            onPress: handleSearch\n          })\n        })\n      }), _jsx(ArtistsFeed, {}), _jsx(Text, {\n        color: \"gray.100\",\n        fontSize: \"lg\",\n        fontWeight: 700,\n        children: \"FEATURED\"\n      }), _jsx(EventsDisplay, {}), _jsx(Text, {\n        color: \"gray.100\",\n        fontSize: \"lg\",\n        fontWeight: 700,\n        children: \"MORE EVENTS\"\n      }), _jsx(UpcomingEvents, {})]\n    })\n  });\n}","map":{"version":3,"names":["React","useEffect","useState","Text","Box","VStack","Input","Icon","Center","ScrollView","Search","useNavigation","useForegroundPermissions","watchPositionAsync","LocationAccuracy","AsyncStorage","Loading","getAddressLocation","ArtistsFeed","EventsDisplay","UpcomingEvents","jsx","_jsx","jsxs","_jsxs","EventsFeed","_useForegroundPermiss","_useForegroundPermiss2","_slicedToArray","locationForegroundPermission","requestLocationForegroundPermission","_useState","_useState2","isLoadingLocation","setIsLoadingLocation","_useState3","_useState4","currentAddress","setCurrentAddress","_useState5","_useState6","inputValue","setInputValue","_useState7","_useState8","selectedCity","setSelectedCity","navigation","granted","subscription","accuracy","High","timeInterval","location","coords","then","address","finally","response","remove","handleSearch","_ref","_asyncToGenerator","latitude","longitude","setItem","JSON","stringify","navigate","apply","arguments","color","fontSize","textAlign","margin","children","contentContainerStyle","flexGrow","showsHorizontalScrollIndicator","flex","bg","px","fontWeight","mt","h","borderRadius","backgroundColor","borderWidth","fontFamily","placeholder","value","onChangeText","text","_focus","borderColor","onSubmitEditing","InputRightElement","mr","as","onPress"],"sources":["/Users/bellacristsantos/Downloads/codeworks/luster/luster/src/screens/EventsFeed.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Image, Text, Box, VStack, Input, Icon, Center, Button, ScrollView } from 'native-base';\nimport Search from '@assets/Search.svg';\nimport { LinearGradient } from 'expo-linear-gradient';\n\nimport { useNavigation } from '@react-navigation/native';\n\nimport {\n  useForegroundPermissions,\n  watchPositionAsync,\n  LocationAccuracy,\n  LocationSubscription,\n} from 'expo-location';\n\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nimport { Loading } from '@components/Loading';\nimport { getAddressLocation } from '@utils/getAddressLocation';\n\nimport { ArtistsFeed } from '@components/ArtistsFeed';\nimport { EventsDisplay } from '@components/EventsDisplay';\nimport { UpcomingEvents } from '@components/EventsDisplay';\n\n\n\n\n\n\nexport function EventsFeed() {\n  const [locationForegroundPermission, requestLocationForegroundPermission] = useForegroundPermissions();\n  const [isLoadingLocation, setIsLoadingLocation] = useState(true);\n  const [currentAddress, setCurrentAddress] = useState<string | null>(null);\n  const [inputValue, setInputValue] = useState('');\n  const [selectedCity, setSelectedCity] = useState<string | null>(null);\n  const navigation = useNavigation();\n\n  useEffect(() => {\n    requestLocationForegroundPermission();\n  }, []);\n\n  useEffect(() => {\n    if (!locationForegroundPermission?.granted) {\n      return;\n    }\n\n    let subscription: LocationSubscription;\n    watchPositionAsync(\n      {\n        accuracy: LocationAccuracy.High,\n        timeInterval: 1000,\n      },\n      (location) => {\n        getAddressLocation(location.coords)\n          .then((address) => {\n            if (address) {\n              setCurrentAddress(address);\n            }\n          })\n          .finally(() => setIsLoadingLocation(false));\n      }\n    ).then((response) => (subscription = response));\n\n    return () => {\n      if (subscription) {\n        subscription.remove();\n      }\n    };\n  }, [locationForegroundPermission]);\n\n  const handleSearch = async () => {\n    const location = await getAddressLocation({ latitude: 0, longitude: 0 });\n    if (location) {\n      await AsyncStorage.setItem('selectedLocation', JSON.stringify(location));\n      setSelectedCity(inputValue);\n      setInputValue('');\n    }\n\n    navigation.navigate('event_details');\n\n  };\n\n  if (!locationForegroundPermission?.granted) {\n    return (\n      <Text color=\"gray.100\" fontSize=\"lg\" textAlign=\"center\" margin={24}>\n        To discover all upcoming music events, allow location access. Head to your device settings and grant Luster permission to access your location.\n      </Text>\n    );\n  }\n\n  if (isLoadingLocation) {\n    return <Loading />;\n  }\n\n  return (\n    <ScrollView contentContainerStyle={{ flexGrow: 1 }} showsHorizontalScrollIndicator={false}>\n      <VStack flex={1} bg=\"gray.700\" px={22}>\n\n        <Text color=\"gray.100\" fontSize=\"sm\" fontWeight={400} mt={20}>\n          Your Location\n        </Text>\n\n        {selectedCity ? (\n          <Center>\n            <Text color=\"gray.100\" fontSize=\"xl\">\n              {selectedCity}\n            </Text>\n          </Center>\n        ) : (\n          <Text color=\"gray.100\" fontSize=\"lg\" fontWeight={700}>\n            {currentAddress}\n          </Text>\n        )}\n\n        <Input\n          px={2}\n          h={14}\n          mt={4}\n          borderRadius={8}\n          backgroundColor=\"transparent\"\n          borderWidth={0.4}\n          fontSize=\"xs\"\n          fontFamily=\"body\"\n          placeholder=\"Search\"\n          color=\"gray.100\"\n          value={inputValue}\n          onChangeText={(text) => setInputValue(text)}\n          _focus={{\n            borderWidth: 1,\n            borderColor: 'purple.900',\n          }}\n          onSubmitEditing={handleSearch}\n          InputRightElement={\n            <Box mr={2} mt={1.8}>\n              <Icon as={<Search />} onPress={handleSearch} />\n            </Box>\n          }\n        />\n\n        <ArtistsFeed />\n\n        <Text color=\"gray.100\" fontSize=\"lg\" fontWeight={700}>\n          FEATURED\n        </Text>\n\n        <EventsDisplay/>\n\n\n        <Text color=\"gray.100\" fontSize=\"lg\" fontWeight={700}>\n          MORE EVENTS\n        </Text>\n\n          <UpcomingEvents />\n\n      </VStack>\n    </ScrollView>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}